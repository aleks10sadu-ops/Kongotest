# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase Storage –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

## –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ Buckets –≤ Supabase Dashboard

**–í–ê–ñ–ù–û:** Buckets –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω—ã –∫–∞–∫ **Public bucket**! –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

–ù—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –¥–≤–∞ bucket'–∞:

### Bucket 1: dish-images (–¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –±–ª—é–¥)

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç –≤ [Supabase Dashboard](https://app.supabase.com)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **Storage** (–≤ –±–æ–∫–æ–≤–æ–º –º–µ–Ω—é)
3. –ù–∞–∂–º–∏—Ç–µ **New bucket**
4. –ù–∞–∑–≤–∞–Ω–∏–µ bucket: `dish-images`
5. **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** –≤—ã–±–µ—Ä–∏—Ç–µ **Public bucket** (—á—Ç–æ–±—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±—ã–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ –ø—É–±–ª–∏—á–Ω—ã–º URL)
   - –ï—Å–ª–∏ bucket —É–∂–µ —Å–æ–∑–¥–∞–Ω, –Ω–æ –Ω–µ –ø—É–±–ª–∏—á–Ω—ã–π:
     - –û—Ç–∫—Ä–æ–π—Ç–µ bucket
     - –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É –Ω–∞—Å—Ç—Ä–æ–µ–∫ (‚öôÔ∏è)
     - –í–∫–ª—é—á–∏—Ç–µ –æ–ø—Ü–∏—é **Public bucket**
6. –ù–∞–∂–º–∏—Ç–µ **Create bucket**

### Bucket 2: content-images (–¥–ª—è –∑–∞–ª–æ–≤, –≤–∞–∫–∞–Ω—Å–∏–π, —Å–æ–±—ã—Ç–∏–π, –±–ª–æ–≥–∞)

1. –í —Ç–æ–º –∂–µ —Ä–∞–∑–¥–µ–ª–µ **Storage** –Ω–∞–∂–º–∏—Ç–µ **New bucket**
2. –ù–∞–∑–≤–∞–Ω–∏–µ bucket: `content-images`
3. **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** –≤—ã–±–µ—Ä–∏—Ç–µ **Public bucket**
   - –ï—Å–ª–∏ bucket —É–∂–µ —Å–æ–∑–¥–∞–Ω, –Ω–æ –Ω–µ –ø—É–±–ª–∏—á–Ω—ã–π:
     - –û—Ç–∫—Ä–æ–π—Ç–µ bucket
     - –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É –Ω–∞—Å—Ç—Ä–æ–µ–∫ (‚öôÔ∏è)
     - –í–∫–ª—é—á–∏—Ç–µ –æ–ø—Ü–∏—é **Public bucket**
4. –ù–∞–∂–º–∏—Ç–µ **Create bucket**

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ bucket –∫–∞–∫ –ø—É–±–ª–∏—á–Ω–æ–≥–æ:

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è bucket'–∞:
1. –û—Ç–∫—Ä–æ–π—Ç–µ bucket –≤ Supabase Dashboard
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö bucket —É–∫–∞–∑–∞–Ω–æ **Public bucket: Yes**
3. –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ **No**, –∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É –Ω–∞ **Yes**

**–í–ê–ñ–ù–û:** –ï—Å–ª–∏ bucket –Ω–µ –ø—É–±–ª–∏—á–Ω—ã–π, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –∏ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –æ—à–∏–±–∫—É 400 –∏–ª–∏ 403!

### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ bucket –ø—É–±–ª–∏—á–Ω—ã–π:

1. –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard ‚Üí Storage
2. –ù–∞–π–¥–∏—Ç–µ bucket `content-images`
3. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ç—Ä–∏ —Ç–æ—á–∫–∏ (‚ãÆ) —Ä—è–¥–æ–º —Å bucket
4. –í—ã–±–µ—Ä–∏—Ç–µ **Edit bucket**
5. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å **Public bucket** –≤–∫–ª—é—á–µ–Ω (–∑–µ–ª–µ–Ω—ã–π)
6. –ï—Å–ª–∏ –≤—ã–∫–ª—é—á–µ–Ω - –≤–∫–ª—é—á–∏—Ç–µ –µ–≥–æ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ

## –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ RLS (Row Level Security) –ø–æ–ª–∏—Ç–∏–∫

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è bucket'–æ–≤, –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–æ—Å—Ç—É–ø–∞:

### –ü–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è dish-images (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–ª—é–¥)

#### –ü–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è (Public access)
```sql
-- –†–∞–∑—Ä–µ—à–∞–µ–º –≤—Å–µ–º —á–∏—Ç–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–ª—é–¥
DROP POLICY IF EXISTS "Public read dish-images" ON storage.objects;
CREATE POLICY "Public read dish-images"
ON storage.objects
FOR SELECT
USING (bucket_id = 'dish-images');
```

#### –ü–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∞–¥–º–∏–Ω–æ–≤)
```sql
-- –†–∞–∑—Ä–µ—à–∞–µ–º —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∞–º –∑–∞–≥—Ä—É–∂–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–ª—é–¥
DROP POLICY IF EXISTS "Admins upload dish-images" ON storage.objects;
CREATE POLICY "Admins upload dish-images"
ON storage.objects
FOR INSERT
WITH CHECK (
  bucket_id = 'dish-images' AND
  EXISTS (
    SELECT 1 FROM public.admins
    WHERE id = auth.uid()
  )
);
```

#### –ü–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∞–¥–º–∏–Ω–æ–≤)
```sql
-- –†–∞–∑—Ä–µ—à–∞–µ–º —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∞–º —É–¥–∞–ª—è—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–ª—é–¥
DROP POLICY IF EXISTS "Admins delete dish-images" ON storage.objects;
CREATE POLICY "Admins delete dish-images"
ON storage.objects
FOR DELETE
USING (
  bucket_id = 'dish-images' AND
  EXISTS (
    SELECT 1 FROM public.admins
    WHERE id = auth.uid()
  )
);
```

### –ü–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è content-images (–∑–∞–ª—ã, –≤–∞–∫–∞–Ω—Å–∏–∏, —Å–æ–±—ã—Ç–∏—è, –±–ª–æ–≥)

#### –ü–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è (Public access)
```sql
-- –†–∞–∑—Ä–µ—à–∞–µ–º –≤—Å–µ–º —á–∏—Ç–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
DROP POLICY IF EXISTS "Public read content-images" ON storage.objects;
CREATE POLICY "Public read content-images"
ON storage.objects
FOR SELECT
USING (bucket_id = 'content-images');
```

#### –ü–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∞–¥–º–∏–Ω–æ–≤)
```sql
-- –†–∞–∑—Ä–µ—à–∞–µ–º —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∞–º –∑–∞–≥—Ä—É–∂–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
DROP POLICY IF EXISTS "Admins upload content-images" ON storage.objects;
CREATE POLICY "Admins upload content-images"
ON storage.objects
FOR INSERT
WITH CHECK (
  bucket_id = 'content-images' AND
  EXISTS (
    SELECT 1 FROM public.admins
    WHERE id = auth.uid()
  )
);
```

#### –ü–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∞–¥–º–∏–Ω–æ–≤)
```sql
-- –†–∞–∑—Ä–µ—à–∞–µ–º —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∞–º —É–¥–∞–ª—è—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
DROP POLICY IF EXISTS "Admins delete content-images" ON storage.objects;
CREATE POLICY "Admins delete content-images"
ON storage.objects
FOR DELETE
USING (
  bucket_id = 'content-images' AND
  EXISTS (
    SELECT 1 FROM public.admins
    WHERE id = auth.uid()
  )
);
```

## –®–∞–≥ 3: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤

–§–∞–π–ª—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ä–≥–∞–Ω–∏–∑—É—é—Ç—Å—è –≤ –ø–∞–ø–∫–∏:

### dish-images bucket:
- `dishes/{dishId}/{timestamp}-{random}.{ext}` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–ª—é–¥
- `dishes/temp/{timestamp}-{random}.{ext}` - –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∑–∫–∏

### content-images bucket:
- `halls/{postId}/{timestamp}-{random}.{ext}` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–ª–æ–≤
- `vacancies/{postId}/{timestamp}-{random}.{ext}` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–∞–∫–∞–Ω—Å–∏–π
- `events/{postId}/{timestamp}-{random}.{ext}` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π
- `blog/{postId}/{timestamp}-{random}.{ext}` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–ª–æ–≥–∞
- `{category}/temp/{timestamp}-{random}.{ext}` - –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∑–∫–∏

## –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –î–ª—è –±–ª—é–¥:
1. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–∞ —Å–∞–π—Ç–µ
2. –û—Ç–∫—Ä–æ–π—Ç–µ –ª—é–±–æ–µ –±–ª—é–¥–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
3. –ù–∞–∂–º–∏—Ç–µ "üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"
4. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
5. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –∏ –ø–æ—è–≤–∏—Ç—å—Å—è –≤ Supabase Storage

### –î–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–∑–∞–ª—ã, –≤–∞–∫–∞–Ω—Å–∏–∏, —Å–æ–±—ã—Ç–∏—è, –±–ª–æ–≥):
1. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–∞ —Å–∞–π—Ç–µ
2. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–∞–∑–¥–µ–ª —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ª–∞–º–∏")
3. –°–æ–∑–¥–∞–π—Ç–µ –∏–ª–∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –∑–∞–ø–∏—Å—å
4. –ù–∞–∂–º–∏—Ç–µ "üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"
5. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
6. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π bucket

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Supabase Storage

- ‚úÖ **–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç–∞—Ä–∏—Ñ**: 500 –ú–ë —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
- ‚úÖ **CDN**: –ë—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –†–∞–±–æ—Ç–∞–µ—Ç —Å –≤–∞—à–µ–π —Ç–µ–∫—É—â–µ–π Supabase –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- ‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –õ–µ–≥–∫–æ —É–≤–µ–ª–∏—á–∏—Ç—å –æ–±—ä–µ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã

–ï—Å–ª–∏ Supabase Storage –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

1. **Cloudinary** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
2. **Vercel Blob Storage** - –µ—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –Ω–∞ Vercel
3. **AWS S3** - –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö

## –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –¥—Ä—É–≥–∏—Ö –º–µ—Å—Ç–∞—Ö (Unsplash, –ª–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã), –∏—Ö –º–æ–∂–Ω–æ:
- –û—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å (–≤–Ω–µ—à–Ω–∏–µ URL)
- –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤ Supabase Storage —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –º–∞—Å—Å–æ–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–∏

